---
title: "Nestling-Temp-Cort"
author: "Erica Griffin"
date: "2025-10-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(gamm4)
library(dplyr)
library(lme4)
library(MASS)
library(lmerTest)
library(here)
library(DHARMa)
library(MuMIn)
weather_df <- read.csv(here("IntermediateData", "weather_df.csv"))
weather_df$log_bleed1_final_cort <- log(weather_df$bleed1_final_cort)
weather_df$log_bleed2_final_cort <- log(weather_df$bleed2_final_cort)
weather_df$log_bleed3_final_cort <- log(weather_df$bleed3_final_cort)
sex_df <- read.csv(here("IntermediateData", "9-19-25_data.csv"))
sex_df$log_bleed1_final_cort <- log(sex_df$bleed1_final_cort)
sex_df$log_bleed2_final_cort <- log(sex_df$bleed2_final_cort)
sex_df$log_bleed3_final_cort <- log(sex_df$bleed3_final_cort)
```

# Environmental effects on corticosterone in nestling tree swallows

### Last updated: October 2, 2025

## Abstract:

For an individual, the ability to cope with challenges is fundamental to surviving in a changing environment. The corticosterone stress response has a major impact on the ability of an organism to react to the challenges of rapid environmental change. Previous research has shown that when faced with a prolonged cold snap, adult female tree swallows increase their baseline and stress-induced corticosterone levels, and that individual variation in corticosterone levels predicts reproductive success during challenges. Tree swallows are advancing reproduction with warming springs and are more likely to encounter cold snaps during breeding, which can reduce reproductive success. Here, using data from a long-term study of free-living tree swallows collected from 2013-2025, we show that nestling tree swallows show an immediate increase in corticosterone levels when ambient temperatures fall below a threshold of 18.5Â°C, which has previously been identified as the threshold at which insect availability begins to decline. As a result of earlier reproduction, nestlings are more likely to experience cold snaps during development, making it especially important to understand their effects. Ongoing work is also testing whether male and female nestlings display dimorphism in their corticosterone responses to further our understanding of how nestlings are responding to thermal environmental shifts.

## Research Questions:

1)  How does temperature influence nestling corticosterone levels?
2)  
    2)  Do male and female nestlings differ in their corticosterone regulation?
3)  
    3)  does sex mediate the effect of temperature on the corticosterone response in nestlings?

## Hypotheses:

1)  Lower temperatures during developmental periods lead to increased corticosterone responses;
2)  Corticosterone regulation in nestlings will be mediated by sex; and
3)  lower temperatures during developmental periods induce sex-specific effects on the stress response in nestling tree swallows.

## Predictions:

Hypothesis 1: Temperature will show a negative relationship with baseline and stress-induced corticosterone, with there being an increase in these measures when both average daily temperatures and average 3-day temperatures are lower; Temperature will have no relationship with post-dex corticosterone levels.

Hypothesis 2: Males and females will show base differences in their corticosterone regulation, with females showing lower corticosterone across all measures, based on previous studies done in adult birds (baseline corticosterone, stress-induced corticosterone, and post-dex corticosterone).

Hypothesis 3:Females will showcase a stronger corticosterone response (across all measures) in response to lower temperatures, consistent with prior work in our population showing that females may more sensitive to some stressors

## Initial results:

Hypothesis 1: It looks like that baseline cort is related to average daily temperature, with lower temperatures resulting in higher baseline cort. There is no (significant) effect of daily temperature on stress-induced cort or post-dex cort.

Hypothesis 2: There is no support in either direction to indicate that nestling cort differs based on sex.

Hypothesis 3: There is no significant support suggesting that either females nor males showcase a stronger corticosterone response across all measures in response to temperature.

# Question 1: How does temperature influence nestling corticosterone levels?

Here, we are running analyses with both average temperature of capture day and average 3 day temperature (before capture) to see what is a better predictor. In general, it looks like there is no huge difference, but daily temperature may be a slightly better predictor based on the co-efficient values. Going forward, I will continue to use avereage daily temperature to test Hypothesis 2 and 3.

## Baseline corticosterone

Daily average:

```{r}
bleed1_weather <- lmer(log_bleed1_final_cort ~ avgC_capture_day + bleed1_latency_sec + ( 1 | nest_key), data = weather_df)
summary(bleed1_weather)
```

```{r}
simulationOutput = simulateResiduals(bleed1_weather, plot = F)
```

```{r}
plot(simulationOutput)
testDispersion(simulationOutput)
```

3 day average:

```{r}
bleed1_weather2 <- lmer(log_bleed1_final_cort ~ avgC_3day + bleed1_latency_sec + ( 1 | nest_key), data = weather_df)
summary(bleed1_weather2)
```

### Stress-induced corticosterone

Daily average:

```{r}
bleed2weather <- lmer(log_bleed2_final_cort ~ avgC_capture_day + log_bleed1_final_cort + ( 1 | nest_key), data = weather_df)
summary(bleed2weather)
```

```{r}
simulationOutput = simulateResiduals(bleed2weather, plot = F)
```

```{r}
plot(simulationOutput)
testDispersion(simulationOutput)
```

3 day average:

```{r}
bleed2weather2 <- lmer(log_bleed2_final_cort ~ avgC_3day + log_bleed1_final_cort + ( 1 | nest_key), data = weather_df)
summary(bleed2weather2)
```

### Post-dex corticosterone

Daily average:

```{r}
bleed3weather <- lmer(log_bleed3_final_cort ~ avgC_capture_day + log_bleed1_final_cort + ( 1 | nest_key), data = weather_df)
summary(bleed3weather)
```

```{r}
simulationOutput = simulateResiduals(bleed3weather, plot = F)
```

```{r}
plot(simulationOutput)
testDispersion(simulationOutput)
```

3 day average:

```{r}
bleed3weather2 <- lmer(log_bleed3_final_cort ~ avgC_3day + log_bleed1_final_cort + ( 1 | nest_key), data = weather_df)
summary(bleed3weather2)
```

# Question 2: Do male and female nestlings differ in their corticosterone regulation

### Baseline corticosterone

```{r}
bleed1_sex <- lmer(log_bleed1_final_cort ~ sex + bleed1_latency_sec + ( 1 | nest_key), data = sex_df)
summary(bleed1_sex)
```

```{r}
simulationOutput = simulateResiduals(bleed1_sex, plot = F)
plot(simulationOutput)
testDispersion(simulationOutput)
```

### Stress-induced corticosterone

```{r}
bleed2_sex <- lmer(log_bleed2_final_cort ~ sex + log_bleed1_final_cort + ( 1 | nest_key), data = sex_df)
summary(bleed2_sex)
```

```{r}
simulationOutput = simulateResiduals(bleed2_sex, plot = F)
plot(simulationOutput)
testDispersion(simulationOutput)
```

### Post-dex corticosterone

```{r}
bleed3_sex <- lmer(log_bleed3_final_cort ~ sex + log_bleed1_final_cort + ( 1 | nest_key), data = sex_df)
summary(bleed3_sex)
```

```{r}
simulationOutput = simulateResiduals(bleed3_sex, plot = F)
plot(simulationOutput)
testDispersion(simulationOutput)
```

# Question 3: Does sex mediate the effect of temperature on the corticosterone response in nestlings?

### Baseline corticosterone

```{r}
bleed1_int <- lmer(log_bleed1_final_cort ~ avgC_capture_day + sex + avgC_capture_day*sex + bleed1_latency_sec + (1 | nest_key), data = sex_df)
summary(bleed1_int)
```

```{r}
simulationOutput = simulateResiduals(bleed1_int, plot = F)
plot(simulationOutput)
testDispersion(simulationOutput)
```

### Stress-induced corticosterone

```{r}
bleed2_int <- lmer(log_bleed2_final_cort ~ avgC_capture_day + sex + avgC_capture_day*sex + log_bleed1_final_cort + (1 | nest_key), data = sex_df)
summary(bleed2_int)
```

```{r}
simulationOutput = simulateResiduals(bleed2_int, plot = F)
plot(simulationOutput)
testDispersion(simulationOutput)
```

### Post-dex corticosterone

```{r}
bleed3_int <- lmer(log_bleed3_final_cort ~ avgC_capture_day + sex + avgC_capture_day*sex + log_bleed1_final_cort + (1 | nest_key), data = sex_df)
summary(bleed3_int)
```

```{r}
simulationOutput = simulateResiduals(bleed3_int, plot = F)
plot(simulationOutput)
testDispersion(simulationOutput)
```
